---
title: "MATH2349 Semester 1, 2018"
author: "Ch#"
subtitle: Assignment 2
output:
  html_notebook: default
---



## Setup

Install and load the necessary packages to reproduce the report here:

```{r, echo = TRUE, message=FALSE}
library(readr)
library(tidyr)
library(dplyr)
##library(Hmisc)
##library(outliers)
```

## Read WHO Data
Read the WHO data using an appropriate function.

```{r}
WHO <- read_csv("WHO.csv")
```

## Tidy Task 1:
```{r, echo=TRUE}
WHO <- WHO %>% gather(code, value, 5:60)
```

## Tidy Task 2:
```{r}
WHO <- WHO %>% separate(code, into = c("new", "var", "sex"), sep = "_")
WHO <- WHO %>% separate(sex, into = c("sex","age"), sep = 1)
```

## Tidy Task 3:
```{r}
WHO <- WHO %>% spread(var, value)
```

## Tidy Task 4: 
```{r}
WHO <- WHO %>% mutate(age = factor(age, levels=c("014","1524","2534","3544","4554","5564","65"), labels=c("<15","15-24","25-34","35-44","45-54","55-64","65>="), ordered=TRUE))
WHO <- WHO %>% mutate(sex = factor(sex))
```

## Task 5: Filter & Select
Drop the redundant columns `iso2` and `new`, and filter any three countries from the tidy version of the WHO data set. Name this subset of the data frame as `WHO_subset`.

```{r}
WHO_subset <- WHO %>% filter(country %in% c("Afghanistan", "Albania", "Algeria")) %>% select(-(iso2),-(new))
```



## Read Species and Surveys data sets

Read the Species and Surveys data sets using an appropriate function. Name these data frames as `species` and `surveys`, respectively.

```{r}
library(kableExtra)
library(knitr)
```

```{r}
options(knitr.table.format = "html")
```

```{r}
# This is an R chunk for reading the Species and Surveys data sets. Provide your R codes here:
species <- read_csv("species.csv")
surveys <- read_csv("surveys.csv")
```

Message: Parsed with column specification ??? (meaning?)

## Task 6: Join

### Exploring the Data
```{r}
dim(species)
```
```{r}
dim(surveys)
```
```{r}
str(species)
summary(species)
```

```{r}
str(surveys)
summary(surveys)
```

Combine `surveys` and `species` data frames using the key variable `species_id`. For this task, you need to add the species information (`genus`, `species`, `taxa`) to the `surveys` data.  Rename the combined data frame as `surveys_combined`.

```{r}
# This is a chunk for Task 6. Provide your R codes here: 
surveys_combined <- full_join(species, surveys, by = "species_id")
```

## Task 7: Calculate 

Using the `surveys_combined` data frame, calculate the average weight and hindfoot length of one of the species observed in each month (irrespective of the year). Make sure to exclude missing values while calculating the average.

```{r}
# This is a chunk for Task 7. Provide your R codes here: 

```

```{r}
# Check the species ID
unique(surveys_combined$species_id)
```

```{r}
# Randomly choose DS
# Made this into a dataset
DS <- subset(surveys_combined, surveys_combined$species_id == "DS")
```

```{r}
str(DS)
```


```{r}
# Create a vector of NAs
is.na(DS$hindfoot_length)

mean(x, na.rm = TRUE)

```


```{r}
DS$month <- factor(DS$month)
```

```{r}
str(DS$month)
```

```{r}
DS_WeightByMonth <- aggregate(DS$weight ~ month, DS, mean, na.action = na.omit)
```

```{r}
kable(DS_WeightByMonth, col.names = c('Month', 'Average Weight'), align = rep('c')) %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "left") %>%
  column_spec(1, bold = TRUE, border_right = TRUE, width = "5em") %>%
  column_spec(2, width = "10em")
```

```{r}
DS_HFLenghtByMonth <- aggregate(DS$hindfoot_length ~ month, DS, mean, na.action = na.omit)
```

```{r}
kable(DS_HFLenghtByMonth, col.names = c('Month', 'Average Hindfoot Length'), align = rep('c')) %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "left") %>%
  column_spec(1, bold = TRUE, border_right = TRUE, width = "5em") %>%
  column_spec(2, width = "10em")
```




```{r}

```

```{r}
month1 <- subset(DS, DS$month == "1")
mean(month1$hindfoot_length, na.rm = TRUE)
```

## Task 8: Missing Values

Select one of the years in the `surveys_combined` data frame, rename this data set as `surveys_combined_year`. Using `surveys_combined_year` data frame, find the total missing values in `weight` column grouped by `species`. Replace the missing values in `weight` column with the mean values of each species. Save this imputed data as `surveys_weight_imputed`.

```{r}
# This is a chunk for Task 8. Provide your R codes here: 





```





## Task 9: Inconsistencies or Special Values

Inspect the `weight` column in `surveys_weight_imputed` data frame for any further inconsistencies or special values (i.e., NaN, Inf, -Inf) . Trace back and explain briefly why you got such a value.

```{r}

# This is a chunk for Task 9. Provide your R codes here: 


```




## Task 10: Outliers

Using the `surveys_combined` data frame, inspect the variable hindfoot length for possible univariate outliers. If you detect any outliers use any of the methods outlined in the Module 6 notes to deal with them. Explain briefly the actions that you take to handle outliers. 

```{r}

# This is a chunk for Task 10. Provide your R codes here: 


```






```{r}
DS$year <- factor(DS$year)
```

```{r}
str(DS$year)
```




<br>
<br>
